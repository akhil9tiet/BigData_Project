{"paragraphs":[{"text":"%md\n# Basic data manipulations\n","user":"anonymous","dateUpdated":"2017-12-04T02:39:55+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"text","editOnDblClick":false},"editorMode":"ace/mode/text"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h1>Basic data manipulations</h1>\n"}]},"apps":[],"jobName":"paragraph_1512342575427_399793444","id":"20171203-230935_488745930","dateCreated":"2017-12-03T23:09:35+0000","dateStarted":"2017-12-04T02:39:55+0000","dateFinished":"2017-12-04T02:39:55+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:161"},{"text":"%pyspark\nfrom pyspark.sql.functions import *\nfrom pyspark.sql.functions import to_timestamp\nfrom pyspark.sql.types import DateType\n\nbikedata=spark.read.csv(\"s3://bikesharebigdata/2017-Q1-Trips-History-Data.csv\",header=True, timestampFormat=\"%m/%d/%Y %H:%M\", inferSchema= \"True\")\n#bikedata\n#bikedata.printSchema()\n#bikedata.columns\n#df = bikedata.selectExpr(\"Duration as Duration\", \"Start date as StartDate\", \"End date as EndDate\", \"Start station as StartStation\", \"End station as EndStation\", \"Bike number as BikeNumber\", \"Member Type as  \"MemberType\")\ndf = bikedata.select(col(\"Duration\").alias(\"Duration\"), \n                     col(\"Start date\").alias(\"StartDate\"), \n                     col(\"End date\").alias(\"EndDate\"),\n                     col(\"Start station\").alias(\"StartStation\"),\n                     col(\"End station\").alias(\"EndStation\"),\n                     col(\"Bike number\").alias(\"BikeNumber\"),\n                     col(\"Member type\").alias(\"MemberType\"))\n\n\n# convert StartDate as DateTime\n\ndf.printSchema()\n\ndf.show()\n","user":"anonymous","dateUpdated":"2017-12-04T04:40:18+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"root\n |-- Duration: integer (nullable = true)\n |-- StartDate: string (nullable = true)\n |-- EndDate: string (nullable = true)\n |-- StartStation: string (nullable = true)\n |-- EndStation: string (nullable = true)\n |-- BikeNumber: string (nullable = true)\n |-- MemberType: string (nullable = true)\n\n+--------+---------------+---------------+--------------------+--------------------+----------+----------+\n|Duration|      StartDate|        EndDate|        StartStation|          EndStation|BikeNumber|MemberType|\n+--------+---------------+---------------+--------------------+--------------------+----------+----------+\n| 1048876|3/31/2017 23:59|  4/1/2017 0:17|      17th & K St NW|Potomac & Pennsyl...|    W20784|Registered|\n|  223449|3/31/2017 23:59|  4/1/2017 0:03|Adams Mill & Colu...|16th & Harvard St NW|    W20825|Registered|\n|  423494|3/31/2017 23:58|  4/1/2017 0:05|M St & Delaware A...|      11th & H St NE|    W20773|Registered|\n|  687015|3/31/2017 23:57|  4/1/2017 0:08|  9th & Upshur St NW|       8th & O St NW|    W01307|Registered|\n|  257919|3/31/2017 23:57|  4/1/2017 0:02|Park Rd & Holmead...|Georgia & New Ham...|    W21760|Registered|\n|  253959|3/31/2017 23:56|  4/1/2017 0:00| 14th & Girard St NW| 11th & Kenyon St NW|    W23036|Registered|\n|  402669|3/31/2017 23:56|  4/1/2017 0:03|      10th & K St NW|       7th & T St NW|    W22539|Registered|\n|  744377|3/31/2017 23:56|  4/1/2017 0:09|37th & O St NW / ...|N Lynn St & Fairf...|    W20893|    Casual|\n|  776845|3/31/2017 23:57|  4/1/2017 0:10|      10th & U St NW|  9th & Upshur St NW|    W00945|Registered|\n|  212823|3/31/2017 23:55|3/31/2017 23:58| 14th & Irving St NW|15th & Euclid St  NW|    W22998|Registered|\n|  338103|3/31/2017 23:55|  4/1/2017 0:00|      14th & R St NW|       7th & T St NW|    W20006|Registered|\n|  883046|3/31/2017 23:55|  4/1/2017 0:10|3000 Connecticut ...|      19th & L St NW|    W00382|    Casual|\n|  534500|3/31/2017 23:54|  4/1/2017 0:03|      10th & U St NW|      18th & R St NW|    W01141|Registered|\n|  384349|3/31/2017 23:54|  4/1/2017 0:00| 11th & Kenyon St NW|15th & Euclid St  NW|    W20333|Registered|\n|  844927|3/31/2017 23:52|  4/1/2017 0:06|      13th & H St NE|       7th & T St NW|    W01112|Registered|\n|  131407|3/31/2017 23:52|3/31/2017 23:54|      15th & P St NW|17th St & Massach...|    W22571|Registered|\n| 1671953|3/31/2017 23:51|  4/1/2017 0:18|Maryland & Indepe...|       4th & E St SW|    W21357|Registered|\n|  519264|3/31/2017 23:51|3/31/2017 23:59|5th St & Massachu...|17th St & Massach...|    W21581|Registered|\n| 1066202|3/31/2017 23:51|  4/1/2017 0:09|Union Market/6th ...|Columbia Rd & Geo...|    W21234|Registered|\n|  200303|3/31/2017 23:50|3/31/2017 23:53|Columbus Circle /...|       8th & F St NE|    W22146|Registered|\n+--------+---------------+---------------+--------------------+--------------------+----------+----------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1512342696466_1389568474","id":"20171203-231136_786455479","dateCreated":"2017-12-03T23:11:36+0000","dateStarted":"2017-12-04T04:40:18+0000","dateFinished":"2017-12-04T04:40:34+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:162"},{"text":"%pyspark\n","user":"anonymous","dateUpdated":"2017-12-04T00:18:15+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1512346695830_801587835","id":"20171204-001815_170147795","dateCreated":"2017-12-04T00:18:15+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:163"}],"name":"BikeShareData","id":"2CZGN9F6X","angularObjects":{"2BRWU4WXC:shared_process":[],"2AM1YV5CU:shared_process":[],"2AJXGMUUJ:shared_process":[],"2ANGGHHMQ:shared_process":[],"2AKK3QQXU:shared_process":[]},"config":{"looknfeel":"default","personalizedMode":"false"},"info":{}}